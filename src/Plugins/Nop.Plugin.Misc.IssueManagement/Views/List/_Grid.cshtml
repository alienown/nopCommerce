@using Nop.Plugin.Misc.IssueManagement.Models
@using Nop.Web.Framework.Models.DataTables

@model IssueSearchModel

@{
    var gridModel = new DataTablesModel
    {
        Name = "issuesGrid",
        UrlRead = new DataUrl("IssueList", "Issue", null),
        SearchButtonId = "search-issues",
        Length = Model.PageSize,
        LengthMenu = Model.AvailablePageSizes,
        Filters = new List<FilterParameter>
        {
            new FilterParameter(nameof(Model.SearchIssueName)),
            new FilterParameter(nameof(Model.SearchIssuePriority)),
            new FilterParameter(nameof(Model.SearchIssueStatus)),
            new FilterParameter(nameof(Model.SearchDeadlineFrom), typeof(DateTime?)),
            new FilterParameter(nameof(Model.SearchDeadlineTo), typeof(DateTime?)),
        }
    };

    gridModel.ColumnCollection.Add(new ColumnProperty(nameof(IssueGridItemModel.Name))
    {
        Title = T("Plugins.Misc.IssueManagement.List.Grid.Columns.Name").Text
    });
    gridModel.ColumnCollection.Add(new ColumnProperty(nameof(IssueGridItemModel.StatusDisplay))
    {
        Title = T("Plugins.Misc.IssueManagement.List.Grid.Columns.Status").Text,
        Width = "100",
        Render = new RenderCustom("gridScope.renderIssueStatus"),
    });
    gridModel.ColumnCollection.Add(new ColumnProperty(nameof(IssueGridItemModel.PriorityDisplay))
    {
        Title = T("Plugins.Misc.IssueManagement.List.Grid.Columns.Priority").Text,
        Width = "100",
        Render = new RenderCustom("gridScope.renderIssuePriority"),
    });
    gridModel.ColumnCollection.Add(new ColumnProperty(nameof(IssueGridItemModel.Deadline))
    {
        Title = T("Plugins.Misc.IssueManagement.List.Grid.Columns.Deadline").Text,
        Width = "170",
        Render = new RenderDate(),
    });
    gridModel.ColumnCollection.Add(new ColumnProperty(nameof(IssueGridItemModel.CreatedBy))
    {
        Title = T("Plugins.Misc.IssueManagement.List.Grid.Columns.CreatedBy").Text,
        Width = "300",
    });
    gridModel.ColumnCollection.Add(new ColumnProperty(nameof(IssueGridItemModel.CreatedAt))
    {
        Title = T("Plugins.Misc.IssueManagement.List.Grid.Columns.CreatedAt").Text,
        Width = "170",
        Render = new RenderDate(),
    });
    gridModel.ColumnCollection.Add(new ColumnProperty(nameof(IssueGridItemModel.LastModified))
    {
        Title = T("Plugins.Misc.IssueManagement.List.Grid.Columns.LastModified").Text,
        Width = "170",
        Render = new RenderDate(),
    });
    gridModel.ColumnCollection.Add(new ColumnProperty(nameof(IssueGridItemModel.Id))
    {
        Title = T("Admin.Common.View").Text,
        Width = "50",
        ClassName = NopColumnClassDefaults.Button,
        Render = new RenderButtonView(new DataUrl("Index"))
    });
}

@await Html.PartialAsync("Table", gridModel)